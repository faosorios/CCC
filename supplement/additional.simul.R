## reading R sources
source("../code/ccc.R")
source("../code/ccc.influence.R")
source("../code/poa.influence.R")
source("ccc.2points.R")
source("poa.2points.R")

## load 'heavy' package required to simulate multivariate normal deviates
library(heavy)

## setting parameters
mu    <- c(0,0)
Sigma <- matrix(c(1,.95,.95,1), ncol = 2)

## Table 1 (seeds: 5, 23, 53, 167, 239, 347, 433)

summary2.ccc(Nsize = 500, nobs = 25, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5  2.0  2.5  3.0  3.5
#C    2.4 21.0 58.8 76.8 85.4 88.6 90.0
#B    2.4 21.0 58.8 76.8 85.4 88.6 90.0
#FI   2.4 14.4 39.4 53.8 58.2 59.4 59.6
#SI   2.4 21.0 58.8 76.8 85.4 88.6 90.0
#both 0.4  7.8 29.0 45.6 52.8 57.8 57.4

summary2.ccc(Nsize = 500, nobs = 50, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5  2.0  2.5  3.0  3.5
#C    1.8 23.2 65.4 87.0 95.8 99.2 99.2
#B    1.8 23.2 65.4 87.0 95.8 99.2 99.2
#FI   3.8 34.2 74.2 87.8 92.2 94.6 94.4
#SI   1.8 23.2 65.4 87.0 95.8 99.2 99.2
#both 0.6 15.2 51.6 76.4 88.4 94.0 93.6

summary2.ccc(Nsize = 500, nobs = 100, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5  2.0  2.5  3.0  3.5
#C    3.2 26.0 59.0 80.4 93.4 99.6 99.2
#B    3.2 26.0 59.0 80.4 93.4 99.6 99.2
#FI   4.6 48.2 87.0 96.6 98.4 99.6 99.2
#SI   3.2 26.0 59.0 80.4 93.4 99.6 99.2
#both 1.6 18.8 52.6 78.2 92.0 99.2 98.4

summary2.ccc(Nsize = 500, nobs = 200, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5  2.0  2.5   3.0 3.5
#C    5.8 32.4 58.2 71.6 91.6  99.2  99
#B    5.8 32.4 58.2 71.6 91.6  99.2  99
#FI   6.0 55.4 92.2 99.8 99.6 100.0 100
#SI   5.8 32.4 58.2 71.6 91.6  99.2  99
#both 2.6 23.8 54.8 71.4 91.2  99.2  99

## Table 2 (seeds: 5, 23, 53, 167, 239, 347, 433)

summary2.poa(Nsize = 500, nobs = 25, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5  2.0  2.5  3.0  3.5
#C    2.0 24.8 62.8 82.0 91.8 97.2 98.4
#B    2.0 24.8 62.8 82.0 91.8 97.2 98.4
#FI   1.8 16.8 43.6 61.2 72.0 78.8 79.4
#SI   2.0 24.8 62.8 82.0 91.8 97.2 98.4
#both 1.8 16.8 43.6 61.2 72.0 78.8 79.4

summary2.poa(Nsize = 500, nobs = 50, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5  2.0  2.5 3.0   3.5
#C    4.0 38.4 85.0 95.6 99.4 100 100.0
#B    4.0 38.4 85.0 95.6 99.4 100 100.0
#FI   4.0 37.8 78.6 92.4 97.0  99  99.2
#SI   4.0 38.4 85.0 95.6 99.4 100 100.0
#both 3.4 34.8 78.6 92.4 97.0  99  99.2

summary2.poa(Nsize = 500, nobs = 100, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5  2.0 2.5 3.0 3.5
#C    3.8 48.4 92.2 99.4 100 100 100
#B    3.8 48.4 92.2 99.4 100 100 100
#FI   4.2 54.6 90.0 97.8 100 100 100
#SI   3.8 48.4 92.2 99.4 100 100 100
#both 3.0 44.2 89.6 97.8 100 100 100

summary2.poa(Nsize = 500, nobs = 200, mean = mu, Sigma = Sigma)
#     0.5  1.0  1.5 2.0 2.5 3.0 3.5
#C    7.6 63.2 97.2 100 100 100 100
#B    7.6 63.2 97.2 100 100 100 100
#FI   6.6 64.2 95.2 100 100 100 100
#SI   7.6 63.2 97.2 100 100 100 100
#both 5.0 55.4 94.2 100 100 100 100
